NOTE: this plugin has been modified
